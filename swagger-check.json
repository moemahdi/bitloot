{"openapi":"3.0.0","paths":{"/healthz":{"get":{"operationId":"HealthController_healthz","summary":"Health check endpoint","parameters":[],"responses":{"200":{"description":"Service is healthy"}},"tags":["Health"]}},"/orders":{"post":{"operationId":"OrdersController_create","summary":"Create a new order","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateOrderDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderResponseDto"}}}}},"tags":["orders"],"security":[{"JWT-auth":[]}]}},"/orders/{id}/checkout":{"get":{"operationId":"OrdersController_getForCheckout","summary":"Get order for checkout (public - UUID is auth)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderResponseDto"}}}},"404":{"description":"Order not found"}},"tags":["orders"]}},"/orders/{id}":{"get":{"operationId":"OrdersController_get","summary":"Get order by ID (requires ownership)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderResponseDto"}}}},"401":{"description":"Unauthorized - missing or invalid JWT"},"403":{"description":"Forbidden - order does not belong to user"},"404":{"description":"Order not found"}},"tags":["orders"],"security":[{"JWT-auth":[]}]}},"/orders/{id}/reservation":{"patch":{"operationId":"OrdersController_setReservation","summary":"Set Kinguin reservation ID (test/internal use)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OrderResponseDto"}}}}},"tags":["orders"]}},"/webhooks/nowpayments/ipn":{"post":{"operationId":"IpnHandlerController_handleNowpaymentsIpn","summary":"NOWPayments IPN Webhook Handler","description":"Receives instant payment notifications from NOWPayments. Verifies signature, deduplicates by payment ID, updates order status, and queues fulfillment if payment is complete. Always returns 200 OK to prevent webhook retries. Rate limited: 30 requests/minute.","parameters":[{"name":"X-NOWPAYMENTS-SIGNATURE","in":"header","description":"HMAC-SHA512 signature of request body (hex string)","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NowpaymentsIpnRequestDto"}}}},"responses":{"200":{"description":"Webhook received and processed (or queued for processing). Always 200 OK regardless of outcome.","schema":{"example":{"ok":true,"message":"Webhook processed","processed":true,"webhookId":"660e8400-e29b-41d4-a716-446655440001"}},"content":{"application/json":{"schema":{"$ref":"#/components/schemas/NowpaymentsIpnResponseDto"}}}}},"tags":["Webhooks"]}},"/webhooks/admin/list":{"get":{"operationId":"IpnHandlerController_adminListWebhooks","summary":"[ADMIN] List all webhook logs with pagination","description":"Requires admin role in JWT token. Returns delivery history for all webhooks.","parameters":[{"name":"page","required":true,"in":"query","schema":{"type":"string"}},{"name":"limit","required":true,"in":"query","schema":{"type":"string"}},{"name":"webhookType","required":true,"in":"query","schema":{"type":"string"}},{"name":"processed","required":true,"in":"query","schema":{"type":"string"}},{"name":"paymentStatus","required":true,"in":"query","schema":{"type":"string"}},{"name":"orderId","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"Paginated webhook logs list","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"externalId":{"type":"string"},"webhookType":{"type":"string","example":"nowpayments_ipn"},"processed":{"type":"boolean"},"signatureValid":{"type":"boolean"},"paymentStatus":{"type":"string","example":"finished"},"orderId":{"type":"string","format":"uuid","nullable":true},"paymentId":{"type":"string","nullable":true},"error":{"type":"string","nullable":true},"attemptCount":{"type":"number"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}},"total":{"type":"number"},"page":{"type":"number"},"limit":{"type":"number"},"totalPages":{"type":"number"},"hasNextPage":{"type":"boolean"}}}}}},"401":{"description":"Unauthorized or missing JWT"},"403":{"description":"Forbidden: user is not admin"}},"tags":["Webhooks"],"security":[{"JWT-auth":[]}]}},"/webhooks/resend/bounce":{"post":{"operationId":"ResendBounceController_handleBounce","summary":"Receive email bounce events from Resend","description":"Webhook endpoint for Resend bounce/complaint events. Updates suppression list.","parameters":[],"requestBody":{"required":true,"description":"Resend webhook event payload","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResendBounceEventDto"}}}},"responses":{"200":{"description":"Bounce event processed"}},"tags":["Webhooks"]}},"/metrics":{"get":{"operationId":"MetricsController_getMetrics","summary":"Get Prometheus metrics","parameters":[],"responses":{"200":{"description":"Prometheus metrics in text format","content":{"application/json":{"schema":{"type":"string"}}}}},"tags":["Metrics"]}},"/emails/unsubscribe":{"post":{"operationId":"EmailUnsubscribeController_unsubscribe","summary":"Unsubscribe from marketing emails (RFC 8058)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UnsubscribeEmailDto"}}}},"responses":{"200":{"description":"Email successfully unsubscribed (or was already unsubscribed)","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UnsubscribeResponseDto"}}}},"400":{"description":"Invalid token or malformed request"}},"tags":["Emails"]}},"/admin/stats":{"get":{"operationId":"AdminController_getDashboardStats","summary":"Get dashboard statistics","description":"Returns aggregated revenue, orders, users, and sales history","parameters":[],"responses":{"200":{"description":"Dashboard statistics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DashboardStatsDto"}}}}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/orders":{"get":{"operationId":"AdminController_getOrders","summary":"Get paginated list of orders","description":"Returns all orders with payment and fulfillment status","parameters":[{"name":"limit","required":false,"in":"query","schema":{"example":50,"type":"number"}},{"name":"offset","required":false,"in":"query","schema":{"example":0,"type":"number"}},{"name":"email","required":false,"in":"query","schema":{"example":"user@example.com","type":"string"}},{"name":"status","required":false,"in":"query","schema":{"example":"fulfilled","type":"string"}}],"responses":{"200":{"description":"Paginated orders list","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"status":{"type":"string"},"total":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"payment":{"type":"object","nullable":true,"properties":{"id":{"type":"string"},"provider":{"type":"string"},"status":{"type":"string"}}}}}},"total":{"type":"number"},"limit":{"type":"number"},"offset":{"type":"number"}}}}}}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/payments":{"get":{"operationId":"AdminController_getPayments","summary":"Get paginated list of payments","description":"Returns payments with order info, filtered by provider and status","parameters":[{"name":"limit","required":false,"in":"query","schema":{"example":50,"type":"number"}},{"name":"offset","required":false,"in":"query","schema":{"example":0,"type":"number"}},{"name":"provider","required":false,"in":"query","schema":{"example":"nowpayments","type":"string"}},{"name":"status","required":false,"in":"query","schema":{"example":"finished","type":"string"}}],"responses":{"200":{"description":"Paginated payments list","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"orderId":{"type":"string"},"externalId":{"type":"string"},"status":{"type":"string"},"provider":{"type":"string"},"priceAmount":{"type":"string"},"priceCurrency":{"type":"string"},"payAmount":{"type":"string"},"payCurrency":{"type":"string"},"order":{"type":"object","properties":{"email":{"type":"string"}}},"createdAt":{"type":"string","format":"date-time"}}}},"total":{"type":"number"},"limit":{"type":"number"},"offset":{"type":"number"}}}}}}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/reservations":{"get":{"operationId":"AdminController_getReservations","summary":"Get paginated list of Kinguin reservations","description":"Returns orders with Kinguin reservation status and ID","parameters":[{"name":"limit","required":false,"in":"query","schema":{"example":50,"type":"number"}},{"name":"offset","required":false,"in":"query","schema":{"example":0,"type":"number"}},{"name":"kinguinReservationId","required":false,"in":"query","schema":{"example":"res_123456","type":"string"}},{"name":"status","required":false,"in":"query","schema":{"example":"fulfilled","type":"string"}}],"responses":{"200":{"description":"Paginated reservations list","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"status":{"type":"string"},"kinguinReservationId":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}}},"total":{"type":"number"},"limit":{"type":"number"},"offset":{"type":"number"}}}}}}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/webhook-logs":{"get":{"operationId":"AdminController_getWebhookLogs","summary":"Get paginated list of webhook logs","description":"Returns webhook history with processing status","parameters":[{"name":"limit","required":false,"in":"query","schema":{"example":50,"type":"number"}},{"name":"offset","required":false,"in":"query","schema":{"example":0,"type":"number"}},{"name":"webhookType","required":false,"in":"query","schema":{"example":"nowpayments_ipn","type":"string"}},{"name":"paymentStatus","required":false,"in":"query","schema":{"example":"processed","type":"string"}}],"responses":{"200":{"description":"Paginated webhook logs","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"externalId":{"type":"string"},"webhookType":{"type":"string"},"paymentStatus":{"type":"string"},"payload":{"type":"object"},"processed":{"type":"boolean"},"signature":{"type":"string"},"signatureValid":{"type":"boolean"},"orderId":{"type":"string"},"paymentId":{"type":"string"},"result":{"type":"string"},"sourceIp":{"type":"string"},"attemptCount":{"type":"number"},"error":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}}},"total":{"type":"number"},"limit":{"type":"number"},"offset":{"type":"number"}}}}}}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/webhook-logs/{id}":{"get":{"operationId":"AdminController_getWebhookLog","summary":"Get webhook log details","description":"Returns full webhook log with payload for inspection","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Webhook log details with payload","content":{"application/json":{"schema":{"type":"object","properties":{"id":{"type":"string"},"webhookType":{"type":"string"},"externalId":{"type":"string"},"paymentStatus":{"type":"string"},"payload":{"type":"object"},"error":{"type":"string"},"createdAt":{"type":"string","format":"date-time"}}}}}},"404":{"description":"Webhook log not found"}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/key-audit/{orderId}":{"get":{"operationId":"AdminController_getKeyAuditTrail","summary":"Get key access audit trail","description":"Returns when keys were revealed to the customer","parameters":[{"name":"orderId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Key access audit trail","content":{"application/json":{"schema":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string"},"viewed":{"type":"boolean"},"viewedAt":{"type":"string","format":"date-time"},"createdAt":{"type":"string","format":"date-time"}}}}}}},"404":{"description":"Order not found or has no keys"}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/webhook-logs/{id}/replay":{"post":{"operationId":"AdminController_replayWebhook","summary":"Replay failed webhook","description":"Marks webhook for reprocessing by resetting status to pending","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Webhook marked for replay"},"400":{"description":"Cannot replay processed webhook"},"404":{"description":"Webhook log not found"}},"tags":["Admin"],"security":[{"JWT-auth":[]}]}},"/admin/ops/feature-flags":{"get":{"operationId":"AdminOpsController_getFeatureFlags","summary":"Get all feature flags","parameters":[],"responses":{"200":{"description":"List of all feature flags with status","content":{"application/json":{"schema":{"type":"array","items":{"properties":{"name":{"type":"string"},"enabled":{"type":"boolean"},"description":{"type":"string"}}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]},"post":{"operationId":"AdminOpsController_createFeatureFlag","summary":"Create new feature flag","parameters":[],"responses":{"201":{"description":"Feature flag created","content":{"application/json":{"schema":{"properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/admin/ops/feature-flags/{name}":{"get":{"operationId":"AdminOpsController_getFeatureFlag","summary":"Get single feature flag","parameters":[{"name":"name","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Feature flag status","content":{"application/json":{"schema":{"properties":{"enabled":{"type":"boolean"},"description":{"type":"string"}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]},"patch":{"operationId":"AdminOpsController_updateFeatureFlag","summary":"Update feature flag","parameters":[{"name":"name","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Feature flag updated","content":{"application/json":{"schema":{"properties":{"success":{"type":"boolean"},"message":{"type":"string"}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/admin/ops/queues/stats":{"get":{"operationId":"AdminOpsController_getQueueStats","summary":"Get BullMQ queue statistics","parameters":[],"responses":{"200":{"description":"Queue statistics (waiting, active, failed)","content":{"application/json":{"schema":{"type":"object","additionalProperties":{"properties":{"waiting":{"type":"number"},"active":{"type":"number"},"failed":{"type":"number"},"delayed":{"type":"number"},"paused":{"type":"number"},"total":{"type":"number"}}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/admin/ops/queues/{name}/details":{"get":{"operationId":"AdminOpsController_getQueueDetails","summary":"Get detailed queue information","parameters":[{"name":"name","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Queue details including recent jobs","content":{"application/json":{"schema":{"properties":{"name":{"type":"string"},"stats":{"properties":{"waiting":{"type":"number"},"active":{"type":"number"},"failed":{"type":"number"},"delayed":{"type":"number"}}},"recentJobs":{"type":"array","items":{"properties":{"id":{"type":"string"},"data":{"type":"object"},"state":{"type":"string"},"progress":{"type":"number"},"attempts":{"type":"number"}}}}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/admin/ops/balance":{"get":{"operationId":"AdminOpsController_getBalance","summary":"Get current balance and account status","parameters":[],"responses":{"200":{"description":"Current balance from payment provider","content":{"application/json":{"schema":{"properties":{"nowpayments":{"properties":{"available":{"type":"string"},"currency":{"type":"string"},"lastUpdated":{"type":"string"}}},"status":{"properties":{"api_connected":{"type":"boolean"},"webhooks_enabled":{"type":"boolean"},"sandbox_mode":{"type":"boolean"}}}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/admin/ops/balance/details":{"get":{"operationId":"AdminOpsController_getBalanceDetails","summary":"Get detailed balance by currency","parameters":[],"responses":{"200":{"description":"Detailed balance information","content":{"application/json":{"schema":{"properties":{"accounts":{"type":"array","items":{"properties":{"currency":{"type":"string"},"balance":{"type":"string"},"pending":{"type":"string"},"locked":{"type":"string"}}}},"totalEUR":{"type":"string"},"lastSync":{"type":"string"}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/admin/ops/health":{"get":{"operationId":"AdminOpsController_getSystemHealth","summary":"Get system health status","parameters":[],"responses":{"200":{"description":"System health check results","content":{"application/json":{"schema":{"properties":{"api":{"properties":{"healthy":{"type":"boolean"},"uptime":{"type":"string"}}},"database":{"properties":{"healthy":{"type":"boolean"},"responseTime":{"type":"string"}}},"redis":{"properties":{"healthy":{"type":"boolean"},"responseTime":{"type":"string"}}},"queues":{"properties":{"healthy":{"type":"boolean"},"failedJobs":{"type":"number"}}}}}}}}},"tags":["Admin - Operations"],"security":[{"JWT-auth":[]}]}},"/auth/request-otp":{"post":{"operationId":"AuthController_requestOtp","summary":"Request OTP code via email","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestOtpDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OtpResponseDto"}}}}},"tags":["Authentication"]}},"/auth/verify-otp":{"post":{"operationId":"AuthController_verifyOtp","summary":"Verify OTP code and get JWT tokens","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyOtpDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}}},"tags":["Authentication"]}},"/auth/refresh":{"post":{"operationId":"AuthController_refresh","summary":"Refresh JWT access token","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuthResponseDto"}}}}},"tags":["Authentication"]}},"/auth/forgot-password":{"post":{"operationId":"AuthController_forgotPassword","summary":"Request password reset email","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ForgotPasswordResponseDto"}}}}},"tags":["Authentication"]}},"/auth/reset-password":{"post":{"operationId":"AuthController_resetPassword","summary":"Reset password with token","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordResponseDto"}}}}},"tags":["Authentication"]}},"/auth/logout":{"post":{"operationId":"AuthController_logout","summary":"Logout user","parameters":[],"responses":{"204":{"description":""}},"tags":["Authentication"]}},"/auth/test/get-otp":{"post":{"operationId":"AuthController_getOtpForTesting","summary":"[TEST ONLY] Get OTP for testing","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"example":{"code":"123456"}}}}}},"tags":["Authentication"]}},"/catalog/categories":{"get":{"operationId":"CatalogController_getCategories","summary":"Get dynamic categories with counts","description":"Returns all available categories (genres, platforms, collections) dynamically aggregated from published products. Also includes featured/virtual categories for special sorts.","parameters":[],"responses":{"200":{"description":"Categories with product counts and featured collections","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CategoriesResponseDto"}}}}},"tags":["Catalog"]}},"/catalog/filters":{"get":{"operationId":"CatalogController_getFilters","summary":"Get available filter options","description":"Returns all available filter options (platforms, regions, genres) with counts, plus price range. Used for building dynamic filter UI.","parameters":[],"responses":{"200":{"description":"Filter options with counts and price range","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FiltersResponseDto"}}}}},"tags":["Catalog"]}},"/catalog/products":{"get":{"operationId":"CatalogController_listProducts","summary":"List products with filtering and pagination","parameters":[{"name":"q","required":false,"in":"query","description":"Search query (full-text)","schema":{"type":"string"}},{"name":"platform","required":false,"in":"query","description":"Filter by platform (Steam, Epic, etc)","schema":{"type":"string"}},{"name":"region","required":false,"in":"query","description":"Filter by region (US, EU, etc)","schema":{"type":"string"}},{"name":"category","required":false,"in":"query","description":"Filter by category","schema":{"type":"string"}},{"name":"sort","required":false,"in":"query","schema":{"enum":["newest","price_asc","price_desc","rating"],"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Items per page (â‰¤ 100)","schema":{"type":"number"}},{"name":"offset","required":false,"in":"query","description":"Pagination offset","schema":{"type":"number"}}],"responses":{"200":{"description":"Paginated product list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductListResponseDto"}}}}},"tags":["Catalog"]}},"/catalog/products/{slug}":{"get":{"operationId":"CatalogController_getProduct","summary":"Get single product by slug","parameters":[{"name":"slug","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Product details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductResponseDto"}}}},"404":{"description":"Product not found"}},"tags":["Catalog"]}},"/catalog/groups":{"get":{"operationId":"GroupsController_listGroups","summary":"List all active product groups","description":"Returns all active product groups for display in the catalog. Groups are ordered by displayOrder then createdAt.","parameters":[],"responses":{"200":{"description":"List of active product groups","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ProductGroupResponseDto"}}}}}},"tags":["Catalog - Groups"]}},"/catalog/groups/{slugOrId}":{"get":{"operationId":"GroupsController_getGroup","summary":"Get product group with all variants","description":"Returns a product group with all its published products. Used to populate the variant selection modal.","parameters":[{"name":"slugOrId","required":true,"in":"path","description":"Group slug (e.g., \"battlefield-6\") or UUID","schema":{"example":"battlefield-6","type":"string"}}],"responses":{"200":{"description":"Product group with all variant products","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupWithProductsDto"}}}},"404":{"description":"Group not found"}},"tags":["Catalog - Groups"]}},"/admin/catalog/products":{"get":{"operationId":"AdminProductsController_listAll","summary":"List products with pagination (admin)","parameters":[{"name":"search","required":false,"in":"query","description":"Search by title","schema":{"type":"string"}},{"name":"platform","required":false,"in":"query","description":"Filter by platform","schema":{"type":"string"}},{"name":"region","required":false,"in":"query","description":"Filter by region","schema":{"type":"string"}},{"name":"published","required":false,"in":"query","description":"Filter by published status (true/false)","schema":{"type":"string"}},{"name":"source","required":false,"in":"query","description":"Filter by source (kinguin/custom)","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number (1-based)","schema":{"example":1,"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Items per page (max 100)","schema":{"example":25,"type":"string"}}],"responses":{"200":{"description":"Paginated products list with total count","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductsListResponseDto"}}}}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]},"post":{"operationId":"AdminProductsController_create","summary":"Create custom product","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProductDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductResponseDto"}}}},"403":{"description":"Feature disabled"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/products/{id}":{"get":{"operationId":"AdminProductsController_getById","summary":"Get product by ID (admin)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductResponseDto"}}}},"404":{"description":"Product not found"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]},"patch":{"operationId":"AdminProductsController_update","summary":"Update product details","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProductDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductResponseDto"}}}},"404":{"description":"Product not found"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]},"delete":{"operationId":"AdminProductsController_delete","summary":"Delete product","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"204":{"description":"Product deleted"},"404":{"description":"Product not found"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/products/bulk-delete":{"post":{"operationId":"AdminProductsController_bulkDelete","summary":"Bulk delete products","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkDeleteProductsDto"}}}},"responses":{"200":{"description":"Products deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkDeleteResponseDto"}}}}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/products/{id}/publish":{"patch":{"operationId":"AdminProductsController_publish","summary":"Publish product (set isPublished=true)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductResponseDto"}}}},"404":{"description":"Product not found"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/products/{id}/unpublish":{"patch":{"operationId":"AdminProductsController_unpublish","summary":"Unpublish product (set isPublished=false)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductResponseDto"}}}},"404":{"description":"Product not found"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/products/{id}/reprice":{"patch":{"operationId":"AdminProductsController_reprice","summary":"Reprice a single product based on current pricing rules","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminProductResponseDto"}}}},"404":{"description":"Product not found"}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/products/bulk-reprice":{"post":{"operationId":"AdminProductsController_bulkReprice","summary":"Bulk reprice products based on current pricing rules","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkRepriceProductsDto"}}}},"responses":{"200":{"description":"Products repriced","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkRepriceResponseDto"}}}}},"tags":["Admin - Catalog Products"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/groups":{"post":{"operationId":"AdminGroupsController_create","summary":"Create a new product group","description":"Creates a new product group for consolidating multiple product variants.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateProductGroupDto"}}}},"responses":{"201":{"description":"Product group created successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupResponseDto"}}}},"400":{"description":"Invalid input"},"409":{"description":"Group with this slug already exists"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]},"get":{"operationId":"AdminGroupsController_list","summary":"List all product groups","description":"Returns paginated list of product groups with optional filters.","parameters":[{"name":"isActive","required":false,"in":"query","description":"Filter by active status","schema":{"type":"boolean"}},{"name":"search","required":false,"in":"query","description":"Search in title","schema":{"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number (1-based)","schema":{"default":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page","schema":{"default":20,"type":"number"}}],"responses":{"200":{"description":"Paginated list of product groups","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupListResponseDto"}}}}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/groups/{id}":{"get":{"operationId":"AdminGroupsController_findById","summary":"Get product group by ID","description":"Returns a single product group with all its products.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"Product group with products","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupWithProductsDto"}}}},"404":{"description":"Group not found"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]},"patch":{"operationId":"AdminGroupsController_update","summary":"Update a product group","description":"Updates an existing product group. All fields are optional.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateProductGroupDto"}}}},"responses":{"200":{"description":"Updated product group","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupResponseDto"}}}},"404":{"description":"Group not found"},"409":{"description":"Slug already exists"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]},"delete":{"operationId":"AdminGroupsController_delete","summary":"Delete a product group","description":"Deletes a product group. Products in the group will become ungrouped.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"responses":{"204":{"description":"Group deleted successfully"},"404":{"description":"Group not found"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/groups/{id}/products":{"post":{"operationId":"AdminGroupsController_assignProducts","summary":"Assign products to a group","description":"Adds one or more products to this group. Products will be removed from any previous group.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AssignProductsToGroupDto"}}}},"responses":{"200":{"description":"Updated group with all products","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupWithProductsDto"}}}},"400":{"description":"One or more product IDs not found"},"404":{"description":"Group not found"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]},"delete":{"operationId":"AdminGroupsController_removeProducts","summary":"Remove products from a group","description":"Removes one or more products from this group. Products become ungrouped.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RemoveProductsFromGroupDto"}}}},"responses":{"200":{"description":"Updated group with remaining products","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProductGroupWithProductsDto"}}}},"404":{"description":"Group not found"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]},"get":{"operationId":"AdminGroupsController_getGroupProducts","summary":"Get all products in a group","description":"Returns all products assigned to this group.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"List of products in the group","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GroupProductVariantDto"}}}}},"404":{"description":"Group not found"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/groups/products/unassigned":{"get":{"operationId":"AdminGroupsController_getUnassignedProducts","summary":"Get all unassigned products","description":"Returns all products that are not assigned to any group. Useful for product assignment UI.","parameters":[],"responses":{"200":{"description":"List of unassigned products","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GroupProductVariantDto"}}}}}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/groups/{id}/refresh-stats":{"post":{"operationId":"AdminGroupsController_refreshStats","summary":"Refresh group statistics","description":"Recalculates min/max price and product count for a group.","parameters":[{"name":"id","required":true,"in":"path","description":"Group UUID","schema":{"type":"string"}}],"responses":{"200":{"description":"Stats refreshed successfully"},"404":{"description":"Group not found"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/groups/refresh-all-stats":{"post":{"operationId":"AdminGroupsController_refreshAllStats","summary":"Refresh all group statistics","description":"Recalculates min/max price and product count for all groups. Use after bulk price changes.","parameters":[],"responses":{"200":{"description":"All stats refreshed successfully"}},"tags":["Admin - Product Groups"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/rules":{"get":{"operationId":"AdminPricingController_listAll","summary":"List all pricing rules (admin only)","parameters":[{"name":"productId","required":true,"in":"query","schema":{"type":"string"}},{"name":"ruleType","required":true,"in":"query","schema":{"type":"string"}},{"name":"isActive","required":true,"in":"query","schema":{"type":"string"}},{"name":"page","required":true,"in":"query","schema":{"type":"string"}},{"name":"limit","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminPricingRulesListResponseDto"}}}}},"tags":["Admin - Catalog Pricing"],"security":[{"JWT-auth":[]}]},"post":{"operationId":"AdminPricingController_create","summary":"Create new pricing rule (admin only)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePricingRuleDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminPricingRuleResponseDto"}}}}},"tags":["Admin - Catalog Pricing"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/rules/{id}":{"get":{"operationId":"AdminPricingController_getById","summary":"Get pricing rule by ID (admin only)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminPricingRuleResponseDto"}}}}},"tags":["Admin - Catalog Pricing"],"security":[{"JWT-auth":[]}]},"patch":{"operationId":"AdminPricingController_update","summary":"Update pricing rule (admin only)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePricingRuleDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminPricingRuleResponseDto"}}}}},"tags":["Admin - Catalog Pricing"],"security":[{"JWT-auth":[]}]},"delete":{"operationId":"AdminPricingController_delete","summary":"Delete pricing rule (admin only)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"204":{"description":""}},"tags":["Admin - Catalog Pricing"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/reprice":{"post":{"operationId":"AdminRepriceController_triggerReprice","summary":"Trigger repricing job","description":"Enqueues a BullMQ job to recalculate prices for all products or a specific product based on dynamic pricing rules","parameters":[{"name":"productId","required":false,"in":"query","description":"Optional: Reprice only this product ID","schema":{"type":"string"}}],"responses":{"202":{"description":"Repricing job enqueued successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RepriceJobResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"}},"tags":["Admin - Catalog Repricing"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/reprice/status":{"get":{"operationId":"AdminRepriceController_getRepriceStatus","summary":"Check repricing job status","description":"Get detailed status of a specific repricing job by ID","parameters":[{"name":"jobId","required":true,"in":"query","description":"The BullMQ job ID to check","schema":{"type":"string"}}],"responses":{"200":{"description":"Job status retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RepriceJobStatusResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"},"404":{"description":"Job not found"}},"tags":["Admin - Catalog Repricing"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/sync":{"post":{"operationId":"AdminSyncController_triggerSync","summary":"Sync imported Kinguin products","description":"Updates all previously-imported Kinguin products with latest data from Kinguin API. Does NOT import new products.","parameters":[],"responses":{"202":{"description":"Sync job enqueued successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SyncJobResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"}},"tags":["Admin - Catalog Sync"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/sync/config":{"get":{"operationId":"AdminSyncController_getConfigStatus","summary":"Check Kinguin integration status","description":"Verify if Kinguin API is properly configured and accessible","parameters":[],"responses":{"200":{"description":"Configuration status","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SyncConfigStatusDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"}},"tags":["Admin - Catalog Sync"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/sync/status":{"get":{"operationId":"AdminSyncController_getSyncStatus","summary":"Check sync job status","description":"Get detailed status of a specific Kinguin sync job by ID","parameters":[{"name":"jobId","required":true,"in":"query","description":"The BullMQ job ID to check","schema":{"type":"string"}}],"responses":{"200":{"description":"Job status retrieved","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SyncJobStatusResponseDto"}}}},"400":{"description":"No job ID provided or invalid"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"},"404":{"description":"Job not found"}},"tags":["Admin - Catalog Sync"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/kinguin/search":{"get":{"operationId":"AdminKinguinController_searchProducts","summary":"Search Kinguin products","description":"Search the Kinguin catalog by product name. Returns matching products with their details. Use this to find products to import.","parameters":[{"name":"query","required":true,"in":"query","description":"Product name to search for (minimum 3 characters)","schema":{"example":"Cyberpunk 2077","type":"string"}},{"name":"platform","required":false,"in":"query","description":"Filter by platform","schema":{"example":"Steam","type":"string"}},{"name":"genre","required":false,"in":"query","description":"Filter by genre","schema":{"example":"RPG","type":"string"}},{"name":"limit","required":false,"in":"query","description":"Maximum results (default: 20, max: 100)","schema":{"example":20,"type":"string"}},{"name":"page","required":false,"in":"query","description":"Page number (default: 1)","schema":{"example":1,"type":"string"}}],"responses":{"200":{"description":"Search results returned","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KinguinSearchResponseDto"}}}},"400":{"description":"Invalid query (min 3 characters)"},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"}},"tags":["Admin Catalog - Kinguin"],"security":[{"JWT-auth":[]}]}},"/admin/catalog/kinguin/import/{productId}":{"post":{"operationId":"AdminKinguinController_importProduct","summary":"Import Kinguin product","description":"Import a specific Kinguin product into the BitLoot catalog. Uses the Kinguin productId from search results.","parameters":[{"name":"productId","required":true,"in":"path","description":"Kinguin product ID to import","schema":{"example":"5c9b5b4b4f4c4c4c4c4c4c4c","type":"string"}}],"responses":{"200":{"description":"Product imported successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/KinguinImportResponseDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden - Admin only"},"404":{"description":"Product not found on Kinguin"}},"tags":["Admin Catalog - Kinguin"],"security":[{"JWT-auth":[]}]}},"/payments/create":{"post":{"operationId":"PaymentsController_create","summary":"Create payment invoice","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreatePaymentDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaymentResponseDto"}}}}},"tags":["payments"]}},"/payments/ipn":{"post":{"operationId":"PaymentsController_ipn","summary":"NOWPayments IPN webhook","description":"Receive payment status updates from NOWPayments. Signature verified with HMAC-SHA512.","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IpnRequestDto"}}}},"responses":{"200":{"description":"Webhook processed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IpnResponseDto"}}}},"400":{"description":"Invalid request body"},"401":{"description":"Invalid HMAC signature"}},"tags":["payments"]}},"/payments/jobs/{jobId}/status":{"get":{"operationId":"PaymentsController_getJobStatus","summary":"Get payment job status","parameters":[{"name":"jobId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Job status with progress"},"404":{"description":"Job not found"}},"tags":["payments"]}},"/payments/admin/list":{"get":{"operationId":"PaymentsController_adminListPayments","summary":"[ADMIN] List all payments with pagination","description":"Requires admin role in JWT token","parameters":[{"name":"page","required":true,"in":"query","schema":{"type":"string"}},{"name":"limit","required":true,"in":"query","schema":{"type":"string"}},{"name":"status","required":true,"in":"query","schema":{"type":"string"}},{"name":"provider","required":true,"in":"query","schema":{"type":"string"}},{"name":"orderId","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"Paginated payments list","content":{"application/json":{"schema":{"type":"object","properties":{"data":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","format":"uuid"},"orderId":{"type":"string","format":"uuid"},"externalId":{"type":"string"},"status":{"type":"string","enum":["created","waiting","confirming","finished","underpaid","failed"]},"provider":{"type":"string"},"priceAmount":{"type":"number"},"priceCurrency":{"type":"string"},"payAmount":{"type":"number"},"payCurrency":{"type":"string"},"createdAt":{"type":"string","format":"date-time"},"updatedAt":{"type":"string","format":"date-time"}}}},"total":{"type":"number"},"page":{"type":"number"},"limit":{"type":"number"},"totalPages":{"type":"number"},"hasNextPage":{"type":"boolean"}}}}}},"401":{"description":"Unauthorized or missing JWT"},"403":{"description":"Forbidden: user is not admin"}},"tags":["payments"],"security":[{"JWT-auth":[]}]}},"/fulfillment/{id}/status":{"get":{"operationId":"FulfillmentController_getStatus","summary":"Get order fulfillment status (requires ownership)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FulfillmentStatusDto"}}}},"401":{"description":"Unauthorized - missing or invalid JWT"},"403":{"description":"Forbidden - order does not belong to user"},"404":{"description":"Order not found"}},"tags":["Fulfillment"],"security":[{"JWT-auth":[]}]}},"/fulfillment/{id}/download-link":{"get":{"operationId":"FulfillmentController_getDownloadLink","summary":"Generate delivery link for fulfilled order (requires ownership)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeliveryLinkDto"}}}},"400":{"description":"Order not fulfilled"},"401":{"description":"Unauthorized - missing or invalid JWT"},"403":{"description":"Forbidden - order does not belong to user"},"404":{"description":"Order not found"}},"tags":["Fulfillment"],"security":[{"JWT-auth":[]}]}},"/fulfillment/{id}/reveal/{itemId}":{"post":{"operationId":"FulfillmentController_revealMyKey","summary":"Reveal encrypted key (requires ownership)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"itemId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RevealedKeyDto"}}}},"401":{"description":"Unauthorized"},"403":{"description":"Forbidden"},"404":{"description":"Order or item not found"}},"tags":["Fulfillment"],"security":[{"JWT-auth":[]}]}},"/fulfillment/{id}/reveal-key/{itemId}":{"post":{"operationId":"FulfillmentController_revealKey","summary":"Admin: Reveal encrypted key (requires admin role)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}},{"name":"itemId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RevealedKeyDto"}}}},"400":{"description":"Order not fulfilled or key unavailable"},"401":{"description":"Unauthorized - not admin"},"404":{"description":"Order or item not found"}},"tags":["Fulfillment"],"security":[{"JWT-auth":[]}]}},"/fulfillment/health/check":{"get":{"operationId":"FulfillmentController_healthCheck","summary":"Health check for fulfillment service","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthCheckResultDto"}}}}},"tags":["Fulfillment"]}},"/kinguin/webhooks":{"post":{"operationId":"KinguinController_handleWebhook","summary":"Webhook receiver for Kinguin eCommerce API events","parameters":[{"name":"X-Event-Secret","in":"header","description":"Secret key for webhook verification","required":true,"schema":{"type":"string"}},{"name":"X-Event-Name","in":"header","description":"Webhook event type (order.status or product.update)","required":true,"schema":{"type":"string"}}],"responses":{"204":{"description":"Webhook acknowledged"},"400":{"description":"Invalid event type or payload"},"401":{"description":"Invalid X-Event-Secret"}},"tags":["Kinguin"]}},"/kinguin/status/{orderId}":{"get":{"operationId":"KinguinController_getStatus","summary":"Query Kinguin order status","parameters":[{"name":"orderId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Order status retrieved","content":{"application/json":{"schema":{"properties":{"id":{"type":"string"},"status":{"type":"string"},"key":{"type":"string"}}}}}},"404":{"description":"Order not found"}},"tags":["Kinguin"]}},"/users/me":{"get":{"operationId":"UsersController_getProfile","summary":"Get current user profile","parameters":[],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponseDto"}}}}},"tags":["Users"],"security":[{"JWT-auth":[]}]}},"/users/me/password":{"patch":{"operationId":"UsersController_updatePassword","summary":"Update user password","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePasswordDto"}}}},"responses":{"200":{"description":"Password updated"}},"tags":["Users"],"security":[{"JWT-auth":[]}]}},"/users/me/orders":{"get":{"operationId":"UsersController_getOrders","summary":"Get user's orders","parameters":[{"name":"page","required":false,"in":"query","description":"Page number (default: 1)","schema":{"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page (default: 20, max: 100)","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OrderResponseDto"}}}}}},"tags":["Users"],"security":[{"JWT-auth":[]}]}},"/admin/audit-logs":{"post":{"operationId":"AuditLogController_create","summary":"Create audit log entry","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateAuditLogDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AuditLogResponseDto"}}}}},"tags":["Audit Logs"],"security":[{"JWT-auth":[]}]},"get":{"operationId":"AuditLogController_query","summary":"Query audit logs with filtering","parameters":[{"name":"adminUserId","required":false,"in":"query","schema":{"type":"string"}},{"name":"action","required":false,"in":"query","schema":{"type":"string"}},{"name":"target","required":false,"in":"query","schema":{"type":"string"}},{"name":"fromDate","required":false,"in":"query","schema":{"type":"string"}},{"name":"toDate","required":false,"in":"query","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","schema":{"minimum":1,"maximum":100,"default":50,"type":"number"}},{"name":"offset","required":false,"in":"query","schema":{"minimum":0,"default":0,"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedAuditLogsDto"}}}}},"tags":["Audit Logs"],"security":[{"JWT-auth":[]}]}},"/admin/audit-logs/export":{"get":{"operationId":"AuditLogController_export","summary":"Export audit logs as JSON","parameters":[{"name":"fromDate","required":true,"in":"query","schema":{"type":"string"}},{"name":"toDate","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AuditLogResponseDto"}}}}}},"tags":["Audit Logs"],"security":[{"JWT-auth":[]}]}},"/reviews":{"get":{"operationId":"ReviewsController_getPublicReviews","summary":"Get approved reviews (public)","parameters":[{"name":"productId","required":false,"in":"query","description":"Filter by product ID","schema":{"type":"string"}},{"name":"limit","required":false,"in":"query","description":"Items per page (default: 10, max: 50)","schema":{"type":"number"}},{"name":"page","required":false,"in":"query","description":"Page number (default: 1)","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedReviewsDto"}}}}},"tags":["Reviews"]},"post":{"operationId":"ReviewsController_createReview","summary":"Submit a review for an order","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateReviewDto"}}}},"responses":{"201":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewResponseDto"}}}},"400":{"description":"Invalid request or order not eligible for review"},"404":{"description":"Order not found"},"409":{"description":"Review already exists for this order"}},"tags":["Reviews"],"security":[{"JWT-auth":[]}]}},"/reviews/homepage":{"get":{"operationId":"ReviewsController_getHomepageReviews","summary":"Get homepage reviews (featured, approved)","parameters":[{"name":"limit","required":false,"in":"query","description":"Number of reviews (default: 6, max: 12)","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ReviewResponseDto"}}}}}},"tags":["Reviews"]}},"/reviews/my":{"get":{"operationId":"ReviewsController_getMyReviews","summary":"Get current user's reviews","parameters":[{"name":"limit","required":false,"in":"query","schema":{"type":"number"}},{"name":"page","required":false,"in":"query","schema":{"type":"number"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedReviewsDto"}}}}},"tags":["Reviews"],"security":[{"JWT-auth":[]}]}},"/reviews/can-review/{orderId}":{"get":{"operationId":"ReviewsController_canReviewOrder","summary":"Check if user can review an order","parameters":[{"name":"orderId","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"canReview":{"type":"boolean"}}}}}}},"tags":["Reviews"],"security":[{"JWT-auth":[]}]}},"/reviews/{id}":{"put":{"operationId":"ReviewsController_updateOwnReview","summary":"Update own review (only while pending)","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateReviewDto"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewResponseDto"}}}},"400":{"description":"Cannot edit after moderation"},"403":{"description":"Cannot edit another user's review"},"404":{"description":"Review not found"}},"tags":["Reviews"],"security":[{"JWT-auth":[]}]},"delete":{"operationId":"ReviewsController_deleteOwnReview","summary":"Delete own review","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"204":{"description":"Review deleted"},"403":{"description":"Cannot delete another user's review"},"404":{"description":"Review not found"}},"tags":["Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews":{"get":{"operationId":"AdminReviewsController_getReviews","summary":"List all reviews with filters (admin)","parameters":[{"name":"page","required":false,"in":"query","description":"Page number (default 1)","schema":{"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Items per page (default 20, max 100)","schema":{"type":"number"}},{"name":"status","required":false,"in":"query","description":"Filter by status","schema":{"enum":["pending","approved","rejected"],"type":"string"}},{"name":"productId","required":false,"in":"query","description":"Filter by product ID","schema":{"type":"string"}},{"name":"userId","required":false,"in":"query","description":"Filter by user ID","schema":{"type":"string"}},{"name":"displayOnHomepage","required":false,"in":"query","description":"Filter by homepage display","schema":{"type":"boolean"}},{"name":"minRating","required":false,"in":"query","description":"Minimum rating (1-5)","schema":{"type":"number"}},{"name":"maxRating","required":false,"in":"query","description":"Maximum rating (1-5)","schema":{"type":"number"}},{"name":"search","required":false,"in":"query","description":"Search in title/content/authorName","schema":{"type":"string"}}],"responses":{"200":{"description":"Paginated list of reviews","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedAdminReviewsDto"}}}}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]},"post":{"operationId":"AdminReviewsController_createReview","summary":"Create a review (admin)","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminCreateReviewDto"}}}},"responses":{"201":{"description":"Review created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminReviewResponseDto"}}}},"400":{"description":"Invalid input"}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/stats":{"get":{"operationId":"AdminReviewsController_getStats","summary":"Get review statistics (admin)","parameters":[],"responses":{"200":{"description":"Review statistics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ReviewStatsDto"}}}}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/{id}":{"get":{"operationId":"AdminReviewsController_getReview","summary":"Get review by ID (admin)","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID (UUID)","schema":{"type":"string"}}],"responses":{"200":{"description":"Review details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminReviewResponseDto"}}}},"404":{"description":"Review not found"}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]},"put":{"operationId":"AdminReviewsController_updateReview","summary":"Update review (admin)","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID (UUID)","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminUpdateReviewDto"}}}},"responses":{"200":{"description":"Review updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminReviewResponseDto"}}}},"404":{"description":"Review not found"}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]},"delete":{"operationId":"AdminReviewsController_deleteReview","summary":"Delete review (admin)","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID (UUID)","schema":{"type":"string"}}],"responses":{"204":{"description":"Review deleted"},"404":{"description":"Review not found"}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/{id}/moderate":{"put":{"operationId":"AdminReviewsController_moderateReview","summary":"Moderate review (approve/reject)","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID (UUID)","schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModerateReviewDto"}}}},"responses":{"200":{"description":"Review moderated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminReviewResponseDto"}}}},"404":{"description":"Review not found"}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/{id}/toggle-homepage":{"put":{"operationId":"AdminReviewsController_toggleHomepageDisplay","summary":"Toggle homepage display for review","parameters":[{"name":"id","required":true,"in":"path","description":"Review ID (UUID)","schema":{"type":"string"}}],"responses":{"200":{"description":"Homepage display toggled","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AdminReviewResponseDto"}}}},"404":{"description":"Review not found"}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/bulk-approve":{"post":{"operationId":"AdminReviewsController_bulkApprove","summary":"Bulk approve reviews","parameters":[],"responses":{"200":{"description":"Reviews approved","content":{"application/json":{"schema":{"properties":{"count":{"type":"number"}}}}}}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/bulk-reject":{"post":{"operationId":"AdminReviewsController_bulkReject","summary":"Bulk reject reviews","parameters":[],"responses":{"200":{"description":"Reviews rejected","content":{"application/json":{"schema":{"properties":{"count":{"type":"number"}}}}}}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/admin/reviews/bulk-delete":{"post":{"operationId":"AdminReviewsController_bulkDelete","summary":"Bulk delete reviews","parameters":[],"responses":{"200":{"description":"Reviews deleted","content":{"application/json":{"schema":{"properties":{"count":{"type":"number"}}}}}}},"tags":["Admin - Reviews"],"security":[{"JWT-auth":[]}]}},"/watchlist":{"get":{"operationId":"WatchlistController_getWatchlist","summary":"Get current user's watchlist","parameters":[{"name":"page","required":false,"in":"query","description":"Page number (1-based)","schema":{"default":1,"example":1,"type":"number"}},{"name":"limit","required":false,"in":"query","description":"Number of items per page (max 50)","schema":{"default":10,"example":10,"type":"number"}}],"responses":{"200":{"description":"Returns paginated watchlist items","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PaginatedWatchlistResponseDto"}}}}},"tags":["Watchlist"],"security":[{"JWT-auth":[]}]},"post":{"operationId":"WatchlistController_addToWatchlist","summary":"Add a product to watchlist","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddToWatchlistDto"}}}},"responses":{"201":{"description":"Product added to watchlist successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WatchlistItemResponseDto"}}}},"404":{"description":"Product not found"},"409":{"description":"Product already in watchlist"}},"tags":["Watchlist"],"security":[{"JWT-auth":[]}]}},"/watchlist/{productId}":{"delete":{"operationId":"WatchlistController_removeFromWatchlist","summary":"Remove a product from watchlist","parameters":[{"name":"productId","required":true,"in":"path","description":"Product ID to remove from watchlist","schema":{"type":"string"}}],"responses":{"204":{"description":"Product removed from watchlist successfully"},"404":{"description":"Item not found in watchlist"}},"tags":["Watchlist"],"security":[{"JWT-auth":[]}]}},"/watchlist/check/{productId}":{"get":{"operationId":"WatchlistController_checkWatchlist","summary":"Check if a product is in watchlist","parameters":[{"name":"productId","required":true,"in":"path","description":"Product ID to check","schema":{"type":"string"}}],"responses":{"200":{"description":"Returns whether product is in watchlist","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CheckWatchlistResponseDto"}}}}},"tags":["Watchlist"],"security":[{"JWT-auth":[]}]}},"/watchlist/count":{"get":{"operationId":"WatchlistController_getWatchlistCount","summary":"Get total number of items in watchlist","parameters":[],"responses":{"200":{"description":"Returns watchlist count","content":{"application/json":{"schema":{"type":"object","properties":{"count":{"type":"number","example":5}}}}}}},"tags":["Watchlist"],"security":[{"JWT-auth":[]}]}}},"info":{"title":"BitLoot API","description":"Crypto-only e-commerce for instant delivery of digital goods","version":"0.0.1","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"JWT-auth":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"CreateOrderDto":{"type":"object","properties":{"email":{"type":"string","example":"user@example.com"},"productId":{"type":"string","default":"demo-product","example":"demo-product"},"note":{"type":"string","example":"Demo order"},"captchaToken":{"type":"string","description":"Cloudflare Turnstile CAPTCHA token for bot protection"}},"required":["email","productId"]},"OrderItemResponseDto":{"type":"object","properties":{"id":{"type":"string"},"productId":{"type":"string"},"sourceType":{"type":"string","description":"Fulfillment source for this item","enum":["custom","kinguin"],"example":"custom"},"signedUrl":{"type":"object","nullable":true}},"required":["id","productId","sourceType","signedUrl"]},"OrderResponseDto":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"userId":{"type":"string"},"status":{"type":"string"},"sourceType":{"type":"string","description":"Overall order fulfillment source","enum":["custom","kinguin"],"example":"custom"},"kinguinReservationId":{"type":"string","description":"Kinguin reservation ID (present when sourceType is kinguin)"},"total":{"type":"string"},"items":{"type":"array","items":{"$ref":"#/components/schemas/OrderItemResponseDto"}},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","email","status","sourceType","total","items","createdAt","updatedAt"]},"NowPaymentsFeeDto":{"type":"object","properties":{"currency":{"type":"string","description":"Fee currency"},"depositFee":{"type":"number","description":"Deposit fee"},"serviceFee":{"type":"number","description":"Service fee"},"withdrawalFee":{"type":"number","description":"Withdrawal fee"}}},"NowpaymentsIpnRequestDto":{"type":"object","properties":{"payment_id":{"description":"NOWPayments payment ID","example":5284800572,"oneOf":[{"type":"number"},{"type":"string"}]},"invoice_id":{"description":"NOWPayments invoice ID (number)","example":5208745935,"oneOf":[{"type":"number"},{"type":"string"}]},"order_id":{"type":"string","description":"Our order UUID","example":"930a98e1-b8fd-4eb0-adb2-f37df3d0bfbe"},"payment_status":{"type":"string","description":"Payment status","example":"finished"},"price_amount":{"type":"number","description":"Expected price amount","example":19.5},"price_currency":{"type":"string","description":"Price currency","example":"eur"},"pay_amount":{"type":"number","description":"Crypto amount to pay","example":0.00025524},"pay_currency":{"type":"string","description":"Pay currency code","example":"btc"},"pay_address":{"type":"string","description":"Crypto payment address","example":"36GMdZsn5ciVZhHEyUfGyoiUmyhAdG5gn3"},"actually_paid":{"type":"number","description":"Amount actually paid","example":0.00025524},"actually_paid_at_fiat":{"type":"number","description":"Amount actually paid in fiat","example":19.5},"received_amount":{"type":"number","description":"Amount received after fees/conversion","example":0.0025},"received_currency":{"type":"string","description":"Currency received","example":"btc"},"outcome_amount":{"type":"number","description":"Outcome amount","example":0.2778371},"outcome_currency":{"type":"string","description":"Outcome currency","example":"ltc"},"fee":{"description":"Fee breakdown","allOf":[{"$ref":"#/components/schemas/NowPaymentsFeeDto"}]},"purchase_id":{"type":"object","description":"NOWPayments purchase ID","example":"5489876303"},"order_description":{"type":"string","description":"Order description","example":"BitLoot Order #930a98e1"},"created_at":{"type":"object","description":"Payment created at","example":"2025-11-08T15:30:00Z"},"updated_at":{"type":"object","description":"Payment updated at","example":1767352373337},"reference":{"type":"string","description":"Optional reference"},"network":{"type":"string","description":"Blockchain network","example":"btc"},"network_precision":{"type":"number","description":"Network precision"},"burning_percent":{"type":"number","description":"Burning percentage"},"expiration_estimate_date":{"type":"string","description":"Payment expiration"},"is_fixed_rate":{"type":"boolean","description":"Is sandbox/test payment"},"is_fee_paid_by_user":{"type":"boolean","description":"Fixed rate enabled"},"valid_until":{"type":"string","description":"Valid until timestamp"},"type":{"type":"string","description":"Payment type"},"smart_contract":{"type":"string","description":"Smart contract address"},"payin_extra_id":{"type":"string","description":"Extra ID (e.g., XRP tag)"},"parent_payment_id":{"type":"object","description":"Parent payment ID (for split payments)"},"payment_extra_ids":{"type":"object","description":"Payment extra IDs"},"deposit_id":{"type":"object","description":"Deposit ID"},"sender_address":{"type":"string","description":"Sender wallet address"},"txn_id":{"type":"string","description":"Blockchain transaction hash"}},"required":["payment_id","invoice_id","order_id","payment_status","price_amount","price_currency"]},"NowpaymentsIpnResponseDto":{"type":"object","properties":{"ok":{"type":"boolean","description":"Webhook received successfully","example":true},"message":{"type":"string","description":"Response message","example":"Webhook received and processed"},"processed":{"type":"boolean","description":"Whether webhook was processed","example":true},"webhookId":{"type":"string","description":"Webhook log ID for audit trail","example":"550e8400-e29b-41d4-a716-446655440000"}},"required":["ok","message","processed","webhookId"]},"ResendBounceEventDto":{"type":"object","properties":{}},"UnsubscribeEmailDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address to unsubscribe","example":"user@example.com"},"token":{"type":"string","description":"Unsubscribe token (prevents unauthorized unsubscribes)","example":"550e8400-e29b-41d4-a716-446655440000"}},"required":["email","token"]},"UnsubscribeResponseDto":{"type":"object","properties":{"status":{"type":"string","description":"Unsubscribe status","example":"success"},"message":{"type":"string","description":"Human-readable message","example":"You have been successfully unsubscribed from BitLoot emails"},"email":{"type":"string","description":"Email that was unsubscribed","example":"user@example.com"},"unsubscribedAt":{"format":"date-time","type":"string","description":"When the unsubscribe took effect (ISO 8601)","example":"2025-11-12T14:32:00.000Z"}},"required":["status","message","email","unsubscribedAt"]},"DashboardStatsDto":{"type":"object","properties":{"totalRevenue":{"type":"number","description":"Total revenue in EUR (cents)","example":125000},"totalOrders":{"type":"number","description":"Total number of orders","example":150},"totalUsers":{"type":"number","description":"Total number of registered users","example":85},"activeOrders":{"type":"number","description":"Active orders (pending/processing)","example":12},"revenueHistory":{"type":"array","description":"Revenue history for the last 7 days","items":{"type":"object","properties":{"date":{"type":"string","example":"2023-11-20"},"revenue":{"type":"number","example":1500}}}}},"required":["totalRevenue","totalOrders","totalUsers","activeOrders","revenueHistory"]},"RequestOtpDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address to send OTP to","example":"user@example.com"},"captchaToken":{"type":"string","description":"Cloudflare Turnstile CAPTCHA token (required if CAPTCHA enabled)","example":"0x4AAAAAABkpwy8Y38VB-QW9..."}},"required":["email"]},"OtpResponseDto":{"type":"object","properties":{"success":{"type":"boolean","description":"Whether OTP was sent successfully","example":true},"expiresIn":{"type":"number","description":"Seconds until OTP expires","example":300},"error":{"type":"string","description":"Error message if OTP request failed"}},"required":["success"]},"VerifyOtpDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address associated with OTP","example":"user@example.com"},"code":{"type":"string","description":"6-digit OTP code","example":"123456","minLength":6,"maxLength":6}},"required":["email","code"]},"UserResponseDto":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"},"emailConfirmed":{"type":"boolean"},"role":{"type":"string"},"createdAt":{"format":"date-time","type":"string"}},"required":["id","email","emailConfirmed","role","createdAt"]},"AuthResponseDto":{"type":"object","properties":{"accessToken":{"type":"string","description":"JWT access token (15 minute expiry)"},"refreshToken":{"type":"string","description":"JWT refresh token (7 day expiry)"},"user":{"description":"User info","allOf":[{"$ref":"#/components/schemas/UserResponseDto"}]}},"required":["accessToken","refreshToken","user"]},"ForgotPasswordDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address to send reset link to","example":"user@example.com"}},"required":["email"]},"ForgotPasswordResponseDto":{"type":"object","properties":{"success":{"type":"boolean","description":"Whether reset email was sent","example":true},"message":{"type":"string","description":"Message to display to user","example":"If an account exists with this email, you will receive a password reset link."}},"required":["success","message"]},"ResetPasswordDto":{"type":"object","properties":{"token":{"type":"string","description":"Password reset token from email link","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"password":{"type":"string","description":"New password (min 8 characters)","example":"NewSecurePassword123!"}},"required":["token","password"]},"ResetPasswordResponseDto":{"type":"object","properties":{"success":{"type":"boolean","description":"Whether password was reset successfully","example":true},"message":{"type":"string","description":"Success message"}},"required":["success","message"]},"CategoryDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique category identifier (slug-format)","example":"action"},"label":{"type":"string","description":"Display label for the category","example":"Action"},"type":{"type":"string","description":"Category type: genre, platform, collection, or custom","enum":["genre","platform","collection","custom"],"example":"genre"},"count":{"type":"number","description":"Number of products in this category","example":150},"icon":{"type":"string","description":"Icon identifier for frontend (lucide icon name)","example":"gamepad-2"},"sortOrder":{"type":"number","description":"Sort order for display","example":1}},"required":["id","label","type","count","sortOrder"]},"FeaturedCategoryDto":{"type":"object","properties":{"id":{"type":"string","description":"Unique identifier for the featured category","example":"trending"},"label":{"type":"string","description":"Display label for the featured category","example":"Trending"},"sort":{"type":"string","description":"Sort type for this featured category","example":"trending"},"icon":{"type":"string","description":"Icon identifier for frontend (lucide icon name)","example":"flame"}},"required":["id","label","sort"]},"CategoriesResponseDto":{"type":"object","properties":{"categories":{"description":"List of available categories","type":"array","items":{"$ref":"#/components/schemas/CategoryDto"}},"featured":{"description":"Featured/special categories (trending, new, etc.)","type":"array","items":{"$ref":"#/components/schemas/FeaturedCategoryDto"}},"totalProducts":{"type":"number","description":"Total number of published products","example":1500}},"required":["categories","featured","totalProducts"]},"PlatformFilterDto":{"type":"object","properties":{"id":{"type":"string","description":"Platform identifier","example":"steam"},"label":{"type":"string","description":"Display name","example":"Steam"},"count":{"type":"number","description":"Number of products on this platform","example":500}},"required":["id","label","count"]},"RegionFilterDto":{"type":"object","properties":{"id":{"type":"string","description":"Region identifier","example":"global"},"label":{"type":"string","description":"Display name","example":"Global"},"count":{"type":"number","description":"Number of products available in this region","example":800}},"required":["id","label","count"]},"GenreFilterDto":{"type":"object","properties":{"id":{"type":"string","description":"Genre identifier (slug-format)","example":"rpg"},"label":{"type":"string","description":"Display name","example":"RPG"},"count":{"type":"number","description":"Number of products in this genre","example":120}},"required":["id","label","count"]},"PriceRangeDto":{"type":"object","properties":{"min":{"type":"number","description":"Minimum price in the catalog","example":0.99},"max":{"type":"number","description":"Maximum price in the catalog","example":149.99},"currency":{"type":"string","description":"Currency code","example":"EUR"}},"required":["min","max","currency"]},"FiltersResponseDto":{"type":"object","properties":{"platforms":{"description":"Available platforms","type":"array","items":{"$ref":"#/components/schemas/PlatformFilterDto"}},"regions":{"description":"Available regions","type":"array","items":{"$ref":"#/components/schemas/RegionFilterDto"}},"genres":{"description":"Available genres","type":"array","items":{"$ref":"#/components/schemas/GenreFilterDto"}},"priceRange":{"description":"Price range","allOf":[{"$ref":"#/components/schemas/PriceRangeDto"}]}},"required":["platforms","regions","genres","priceRange"]},"VideoDto":{"type":"object","properties":{"video_id":{"type":"string","description":"YouTube video ID","example":"dQw4w9WgXcQ"}},"required":["video_id"]},"SystemRequirementDto":{"type":"object","properties":{"system":{"type":"string","description":"System name","example":"Windows"},"requirement":{"description":"List of requirements","type":"array","items":{"type":"string"}}},"required":["system","requirement"]},"ScreenshotDto":{"type":"object","properties":{"url":{"type":"string","description":"Full-size screenshot URL"},"thumbnail":{"type":"string","description":"Thumbnail URL"}},"required":["url","thumbnail"]},"ProductResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Product unique identifier","example":"123e4567-e89b-12d3-a456-426614174000"},"slug":{"type":"string","description":"URL-friendly product identifier","example":"cyberpunk-2077-steam-us"},"title":{"type":"string","description":"Product title","example":"Cyberpunk 2077"},"subtitle":{"type":"string","description":"Product subtitle or edition","example":"Ultimate Edition"},"description":{"type":"string","description":"Detailed product description","example":"An open-world, action-adventure RPG set in the dark future of Night City"},"platform":{"type":"string","description":"Gaming platform","example":"Steam"},"region":{"type":"string","description":"Region code","example":"US"},"drm":{"type":"string","description":"DRM system","example":"Steam"},"ageRating":{"type":"string","description":"Age rating","example":"M - Mature 17+"},"category":{"type":"string","description":"Product category","example":"Games"},"price":{"type":"string","description":"Price in crypto (decimal string)","example":"59.99000000"},"currency":{"type":"string","description":"Currency code","example":"EUR"},"isPublished":{"type":"boolean","description":"Whether product is published and visible","example":true},"imageUrl":{"type":"string","description":"Cover image URL","example":"https://cdn.bitloot.io/products/cyberpunk-2077-cover.jpg"},"createdAt":{"format":"date-time","type":"string","description":"Product creation timestamp","example":"2024-01-15T10:30:00Z"},"updatedAt":{"format":"date-time","type":"string","description":"Last update timestamp","example":"2024-01-20T15:45:00Z"},"developers":{"description":"Game developers","example":["CD Projekt Red"],"type":"array","items":{"type":"string"}},"publishers":{"description":"Game publishers","example":["CD Projekt"],"type":"array","items":{"type":"string"}},"genres":{"description":"Game genres","example":["Action","RPG","Open World"],"type":"array","items":{"type":"string"}},"releaseDate":{"type":"string","description":"Release date (YYYY-MM-DD)","example":"2020-12-10"},"metacriticScore":{"type":"number","description":"Metacritic score (0-100)","example":86},"regionalLimitations":{"type":"string","description":"Regional limitations description","example":"Region free"},"activationDetails":{"type":"string","description":"Activation details / instructions","example":"Download and install the game client, log in to your account, enter the key"},"videos":{"description":"YouTube video trailers","type":"array","items":{"$ref":"#/components/schemas/VideoDto"}},"languages":{"description":"Supported languages","example":["English","German","French","Spanish"],"type":"array","items":{"type":"string"}},"systemRequirements":{"description":"System requirements by OS","type":"array","items":{"$ref":"#/components/schemas/SystemRequirementDto"}},"tags":{"description":"Product tags","example":["base","action","open-world"],"type":"array","items":{"type":"string"}},"steam":{"type":"string","description":"Steam app ID","example":"1091500"},"screenshots":{"description":"Product screenshots","type":"array","items":{"$ref":"#/components/schemas/ScreenshotDto"}},"isPreorder":{"type":"boolean","description":"Is this a pre-order product","example":false},"rating":{"type":"number","description":"Product rating (0-5 scale)","example":4.5}},"required":["id","slug","title","price","currency","isPublished","createdAt","updatedAt"]},"ProductListResponseDto":{"type":"object","properties":{"data":{"description":"Array of products","type":"array","items":{"$ref":"#/components/schemas/ProductResponseDto"}},"total":{"type":"number","description":"Total number of products matching filters","example":150},"limit":{"type":"number","description":"Items per page","example":24},"offset":{"type":"number","description":"Pagination offset","example":0},"pages":{"type":"number","description":"Total number of pages","example":7}},"required":["data","total","limit","offset","pages"]},"ProductGroupResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Group ID"},"title":{"type":"string","description":"Group title"},"slug":{"type":"string","description":"URL slug"},"description":{"type":"string","description":"Description"},"coverImageUrl":{"type":"string","description":"Cover image URL"},"tagline":{"type":"string","description":"Tagline"},"isActive":{"type":"boolean","description":"Is active/visible"},"displayOrder":{"type":"number","description":"Display order"},"minPrice":{"type":"string","description":"Minimum price in group"},"maxPrice":{"type":"string","description":"Maximum price in group"},"productCount":{"type":"number","description":"Number of products in group"},"createdAt":{"format":"date-time","type":"string","description":"Created at"},"updatedAt":{"format":"date-time","type":"string","description":"Updated at"}},"required":["id","title","slug","description","coverImageUrl","tagline","isActive","displayOrder","minPrice","maxPrice","productCount","createdAt","updatedAt"]},"GroupProductVariantDto":{"type":"object","properties":{"id":{"type":"string","description":"Product ID"},"title":{"type":"string","description":"Product title"},"slug":{"type":"string","description":"Product slug"},"platform":{"type":"string","description":"Platform (Steam, PlayStation, Xbox, etc.)"},"region":{"type":"string","description":"Region"},"subtitle":{"type":"string","description":"Edition or type (Standard, Phantom, Account, Key)"},"price":{"type":"string","description":"Retail price"},"currency":{"type":"string","description":"Currency"},"coverImageUrl":{"type":"string","description":"Cover image URL"},"rating":{"type":"number","description":"Product rating"},"isPublished":{"type":"boolean","description":"Is published/available"},"sourceType":{"type":"string","description":"Source type (custom or kinguin)"}},"required":["id","title","slug","platform","region","subtitle","price","currency","coverImageUrl","rating","isPublished","sourceType"]},"ProductGroupWithProductsDto":{"type":"object","properties":{"id":{"type":"string","description":"Group ID"},"title":{"type":"string","description":"Group title"},"slug":{"type":"string","description":"URL slug"},"description":{"type":"string","description":"Description"},"coverImageUrl":{"type":"string","description":"Cover image URL"},"tagline":{"type":"string","description":"Tagline"},"isActive":{"type":"boolean","description":"Is active/visible"},"displayOrder":{"type":"number","description":"Display order"},"minPrice":{"type":"string","description":"Minimum price in group"},"maxPrice":{"type":"string","description":"Maximum price in group"},"productCount":{"type":"number","description":"Number of products in group"},"createdAt":{"format":"date-time","type":"string","description":"Created at"},"updatedAt":{"format":"date-time","type":"string","description":"Updated at"},"products":{"description":"Products in this group","type":"array","items":{"$ref":"#/components/schemas/GroupProductVariantDto"}}},"required":["id","title","slug","description","coverImageUrl","tagline","isActive","displayOrder","minPrice","maxPrice","productCount","createdAt","updatedAt","products"]},"KinguinVideoDto":{"type":"object","properties":{"video_id":{"type":"string","description":"YouTube video ID","example":"dQw4w9WgXcQ"}},"required":["video_id"]},"KinguinSystemRequirementDto":{"type":"object","properties":{"system":{"type":"string","description":"System name","example":"Windows"},"requirement":{"description":"List of requirements","type":"array","items":{"type":"string"}}},"required":["system","requirement"]},"KinguinScreenshotDto":{"type":"object","properties":{"url":{"type":"string","description":"Full-size screenshot URL"},"thumbnail":{"type":"string","description":"Thumbnail URL"}},"required":["url","thumbnail"]},"AdminProductResponseDto":{"type":"object","properties":{"id":{"type":"string"},"externalId":{"type":"string"},"kinguinId":{"type":"number","description":"Kinguin numeric ID","example":20443},"kinguinProductId":{"type":"string","description":"Kinguin product ID string","example":"5c9b5e6b-89f6-4b3d-8f4e-abcdef123456"},"sourceType":{"type":"string","description":"Product fulfillment source","enum":["custom","kinguin"],"example":"custom"},"kinguinOfferId":{"type":"string","description":"Kinguin offer ID (present when sourceType is kinguin)","example":"5c9b5e6b-89f6-4b3d-8f4e-abcdef123456"},"slug":{"type":"string"},"title":{"type":"string"},"name":{"type":"string"},"originalName":{"type":"string","description":"Original product name from Kinguin","example":"Counter-Strike: Source"},"subtitle":{"type":"string"},"description":{"type":"string"},"platform":{"type":"string"},"region":{"type":"string"},"drm":{"type":"string"},"ageRating":{"type":"string"},"category":{"type":"string"},"developers":{"description":"Game developers","example":["Valve"],"type":"array","items":{"type":"string"}},"publishers":{"description":"Game publishers","example":["Valve"],"type":"array","items":{"type":"string"}},"genres":{"description":"Game genres","example":["Action","FPS"],"type":"array","items":{"type":"string"}},"releaseDate":{"type":"string","description":"Release date (YYYY-MM-DD)","example":"2004-11-01"},"qty":{"type":"number","description":"Quantity of cheapest offers","example":100},"textQty":{"type":"number","description":"Quantity of text serials","example":50},"offersCount":{"type":"number","description":"Number of offers","example":5},"totalQty":{"type":"number","description":"Total quantity from all offers","example":200},"isPreorder":{"type":"boolean","description":"Is this a pre-order product","example":false},"metacriticScore":{"type":"number","description":"Metacritic score (0-100)","example":88},"regionalLimitations":{"type":"string","description":"Regional limitations description","example":"Region free"},"countryLimitation":{"description":"Excluded country codes (ISO 2-letter)","example":["DE","AT"],"type":"array","items":{"type":"string"}},"regionId":{"type":"number","description":"Kinguin region ID","example":1},"activationDetails":{"type":"string","description":"Activation details / instructions"},"videos":{"description":"YouTube video IDs","type":"array","items":{"$ref":"#/components/schemas/KinguinVideoDto"}},"languages":{"description":"Supported languages","example":["English","German","French"],"type":"array","items":{"type":"string"}},"systemRequirements":{"description":"System requirements by OS","type":"array","items":{"$ref":"#/components/schemas/KinguinSystemRequirementDto"}},"tags":{"description":"Product tags","example":["base","dlc"],"type":"array","items":{"type":"string"}},"merchantName":{"description":"Cheapest offer seller names","example":["BestSeller","TopGames"],"type":"array","items":{"type":"string"}},"steam":{"type":"string","description":"Steam app ID","example":"730"},"screenshots":{"description":"Product screenshots","type":"array","items":{"$ref":"#/components/schemas/KinguinScreenshotDto"}},"coverThumbnailUrl":{"type":"string","description":"Cover thumbnail URL"},"cheapestOfferId":{"description":"Cheapest offer IDs","type":"array","items":{"type":"string"}},"coverImageUrl":{"type":"string","description":"Cover image URL for product display","example":"https://cdn.kinguin.net/media/images/products/cover.jpg"},"rating":{"type":"number","description":"Product rating (0-5 scale)","example":4.5},"cost":{"type":"string"},"price":{"type":"string"},"currency":{"type":"string"},"isPublished":{"type":"boolean"},"isCustom":{"type":"boolean"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"},"deletedAt":{"format":"date-time","type":"string"}},"required":["id","sourceType","slug","title","name","isPreorder","cost","price","currency","isPublished","isCustom","createdAt","updatedAt"]},"AdminProductsListResponseDto":{"type":"object","properties":{"products":{"description":"Array of products","type":"array","items":{"$ref":"#/components/schemas/AdminProductResponseDto"}},"total":{"type":"number","description":"Total number of products matching filters"},"page":{"type":"number","description":"Current page number (1-based)"},"limit":{"type":"number","description":"Items per page"},"totalPages":{"type":"number","description":"Total number of pages"}},"required":["products","total","page","limit","totalPages"]},"CreateProductDto":{"type":"object","properties":{"sourceType":{"type":"string","description":"Product fulfillment source","enum":["custom","kinguin"],"default":"custom","example":"custom"},"kinguinOfferId":{"type":"string","description":"Kinguin offer ID (required when sourceType is kinguin)","example":"5c9b5e6b-89f6-4b3d-8f4e-abcdef123456"},"title":{"type":"string","description":"Product title"},"subtitle":{"type":"string","description":"Product subtitle"},"description":{"type":"string","description":"Product description"},"platform":{"type":"string","description":"Platform (steam, epic, gog, etc.)"},"region":{"type":"string","description":"Region (us, eu, asia, global)"},"drm":{"type":"string","description":"DRM type"},"ageRating":{"type":"string","description":"Age rating (PEGI-16, ESRB-M, etc.)"},"category":{"type":"string","description":"Category"},"cost":{"type":"string","description":"Wholesale cost (decimal string)","example":"45.00"},"price":{"type":"string","description":"Retail price (decimal string)","example":"59.99"},"currency":{"type":"string","description":"Currency code (EUR)","default":"EUR"},"isPublished":{"type":"boolean","description":"Is published to storefront?","default":false}},"required":["sourceType","title","cost","price","currency","isPublished"]},"UpdateProductDto":{"type":"object","properties":{"sourceType":{"type":"string","description":"Product fulfillment source","enum":["custom","kinguin"],"example":"custom"},"kinguinOfferId":{"type":"string","description":"Kinguin offer ID (required when sourceType is kinguin)","example":"5c9b5e6b-89f6-4b3d-8f4e-abcdef123456"},"title":{"type":"string","description":"Product title"},"subtitle":{"type":"string","description":"Product subtitle"},"description":{"type":"string","description":"Product description"},"platform":{"type":"string","description":"Platform"},"region":{"type":"string","description":"Region"},"drm":{"type":"string","description":"DRM type"},"ageRating":{"type":"string","description":"Age rating"},"category":{"type":"string","description":"Category"},"cost":{"type":"string","description":"Wholesale cost"},"price":{"type":"string","description":"Retail price"},"currency":{"type":"string","description":"Currency code"}}},"BulkDeleteProductsDto":{"type":"object","properties":{"ids":{"description":"Array of product IDs to delete","example":["uuid-1","uuid-2","uuid-3"],"type":"array","items":{"type":"string"}}},"required":["ids"]},"BulkDeleteResponseDto":{"type":"object","properties":{"deleted":{"type":"number","description":"Number of products successfully deleted"},"notFound":{"description":"IDs of products that were not found","type":"array","items":{"type":"string"}}},"required":["deleted"]},"BulkRepriceProductsDto":{"type":"object","properties":{"ids":{"description":"Array of product IDs to reprice","example":["uuid-1","uuid-2","uuid-3"],"type":"array","items":{"type":"string"}}},"required":["ids"]},"BulkRepriceResponseDto":{"type":"object","properties":{"success":{"type":"number","description":"Number of products successfully repriced"},"failed":{"type":"number","description":"Number of products that failed to reprice"}},"required":["success","failed"]},"CreateProductGroupDto":{"type":"object","properties":{"title":{"type":"string","description":"Display title for the group","example":"Battlefield 6"},"slug":{"type":"string","description":"URL-friendly slug (auto-generated if not provided)","example":"battlefield-6"},"description":{"type":"string","description":"Group description"},"coverImageUrl":{"type":"string","description":"Cover image URL (will use first product image if not set)"},"tagline":{"type":"string","description":"Short tagline for the card","example":"Available on 5 platforms"},"isActive":{"type":"boolean","description":"Whether group is visible in catalog","default":true},"displayOrder":{"type":"number","description":"Display order (lower = first)","default":0}},"required":["title","isActive","displayOrder"]},"ProductGroupListResponseDto":{"type":"object","properties":{"groups":{"type":"array","items":{"$ref":"#/components/schemas/ProductGroupResponseDto"}},"total":{"type":"number","description":"Total count"},"page":{"type":"number","description":"Current page"},"limit":{"type":"number","description":"Items per page"},"totalPages":{"type":"number","description":"Total pages"}},"required":["groups","total","page","limit","totalPages"]},"UpdateProductGroupDto":{"type":"object","properties":{"title":{"type":"string","description":"Display title for the group"},"slug":{"type":"string","description":"URL-friendly slug"},"description":{"type":"string","description":"Group description"},"coverImageUrl":{"type":"string","description":"Cover image URL"},"tagline":{"type":"string","description":"Short tagline for the card"},"isActive":{"type":"boolean","description":"Whether group is visible in catalog"},"displayOrder":{"type":"number","description":"Display order (lower = first)"}}},"AssignProductsToGroupDto":{"type":"object","properties":{"productIds":{"description":"Array of product IDs to assign to this group","example":["uuid-1","uuid-2","uuid-3"],"type":"array","items":{"type":"string"}}},"required":["productIds"]},"RemoveProductsFromGroupDto":{"type":"object","properties":{"productIds":{"description":"Array of product IDs to remove from this group","type":"array","items":{"type":"string"}}},"required":["productIds"]},"AdminPricingRuleResponseDto":{"type":"object","properties":{"id":{"type":"string"},"productId":{"type":"object","nullable":true,"description":"Product ID. Null for global rules."},"ruleType":{"type":"string"},"marginPercent":{"type":"string","nullable":true},"fixedMarkupMinor":{"type":"number","nullable":true},"floorMinor":{"type":"number","nullable":true},"capMinor":{"type":"number","nullable":true},"priority":{"type":"number"},"isActive":{"type":"boolean"},"createdAt":{"format":"date-time","type":"string"},"updatedAt":{"format":"date-time","type":"string"}},"required":["id","productId","ruleType","marginPercent","fixedMarkupMinor","floorMinor","capMinor","priority","isActive","createdAt","updatedAt"]},"AdminPricingRulesListResponseDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/AdminPricingRuleResponseDto"}},"total":{"type":"number"},"page":{"type":"number"},"limit":{"type":"number"},"totalPages":{"type":"number"}},"required":["data","total","page","limit","totalPages"]},"CreatePricingRuleDto":{"type":"object","properties":{"productId":{"type":"string","description":"Product ID (UUID). Leave empty for global rule that applies to all products.","format":"uuid"},"ruleType":{"type":"string","description":"Rule type","enum":["margin_percent","fixed_markup","floor_cap","dynamic_adjust"]},"marginPercent":{"type":"string","description":"Margin percentage (e.g., \"35.50\" for 35.5%)"},"fixedMarkupMinor":{"type":"number","description":"Fixed markup in minor units (cents)","minimum":0},"floorMinor":{"type":"number","description":"Floor price in minor units (cents)","minimum":0},"capMinor":{"type":"number","description":"Cap price in minor units (cents)","minimum":0},"priority":{"type":"number","description":"Rule priority (0 = highest)","default":0,"minimum":0},"isActive":{"type":"boolean","description":"Is rule active?","default":true}},"required":["ruleType","priority","isActive"]},"UpdatePricingRuleDto":{"type":"object","properties":{"ruleType":{"type":"string","description":"Rule type","enum":["margin_percent","fixed_markup","floor_cap","dynamic_adjust"]},"marginPercent":{"type":"string","description":"Margin percentage (e.g., \"35.50\" for 35.5%)"},"fixedMarkupMinor":{"type":"number","description":"Fixed markup in minor units (cents)","minimum":0},"floorMinor":{"type":"number","description":"Floor price in minor units (cents)","minimum":0},"capMinor":{"type":"number","description":"Cap price in minor units (cents)","minimum":0},"priority":{"type":"number","description":"Rule priority (0 = highest)","minimum":0},"isActive":{"type":"boolean","description":"Is rule active?"}}},"RepriceJobResponseDto":{"type":"object","properties":{}},"RepriceJobStatusResponseDto":{"type":"object","properties":{}},"SyncJobResponseDto":{"type":"object","properties":{"jobId":{"type":"string","description":"BullMQ job ID"},"status":{"type":"string","description":"Job status (e.g., queued, running, completed)"},"message":{"type":"string","description":"Status message"}},"required":["jobId","status","message"]},"SyncConfigStatusDto":{"type":"object","properties":{"configured":{"type":"boolean","description":"Whether Kinguin API is properly configured"},"message":{"type":"string","description":"Configuration status message"}},"required":["configured","message"]},"SyncJobStatusResponseDto":{"type":"object","properties":{"jobId":{"type":"string","description":"BullMQ job ID"},"status":{"type":"string","description":"Job status (waiting, active, completed, failed)"},"progress":{"type":"number","description":"Progress percentage (0-100)"},"result":{"type":"object","description":"Job result data","properties":{"productsProcessed":{"type":"number"},"productsCreated":{"type":"number"},"productsUpdated":{"type":"number"},"errors":{"type":"array","items":{"type":"string"}}}},"failedReason":{"type":"string","description":"Failure reason if job failed"},"createdAt":{"format":"date-time","type":"string","description":"Job creation timestamp"},"processedOn":{"format":"date-time","type":"string","description":"Processing start timestamp"},"finishedOn":{"format":"date-time","type":"string","description":"Completion timestamp"}},"required":["jobId","status"]},"KinguinProductResultDto":{"type":"object","properties":{"productId":{"type":"string","description":"Kinguin product ID (use this for import)","example":"5c9b5b4b4f4c4c4c4c4c4c4c"},"name":{"type":"string","description":"Product name/title","example":"Cyberpunk 2077"},"originalName":{"type":"string","description":"Original name (if different from localized name)","nullable":true,"example":"Cyberpunk 2077"},"platform":{"type":"string","description":"Platform (Steam, Epic, Origin, etc.)","nullable":true,"example":"Steam"},"price":{"type":"number","description":"Price in EUR","example":29.99},"region":{"type":"string","description":"Product region","nullable":true,"example":"Global"},"coverImageUrl":{"type":"string","description":"Cover image URL","nullable":true,"example":"https://cdn.kinguin.net/media/catalog/product/1234.jpg"},"metacriticScore":{"type":"number","description":"Metacritic score (0-100)","nullable":true,"example":86},"ageRating":{"type":"string","description":"Age rating","nullable":true,"example":"18+"},"alreadyImported":{"type":"boolean","description":"Whether this product is already in BitLoot catalog","example":false}},"required":["productId","name","price","alreadyImported"]},"KinguinSearchResponseDto":{"type":"object","properties":{"results":{"description":"Search results","type":"array","items":{"$ref":"#/components/schemas/KinguinProductResultDto"}},"totalCount":{"type":"number","description":"Total count of results","example":42},"query":{"type":"string","description":"Search query used","example":"Cyberpunk"}},"required":["results","totalCount","query"]},"KinguinImportResponseDto":{"type":"object","properties":{"success":{"type":"boolean","description":"Whether import was successful","example":true},"productId":{"type":"string","description":"Imported product ID in BitLoot catalog","example":"abc123-def456-ghi789"},"title":{"type":"string","description":"Product title","example":"Cyberpunk 2077"},"message":{"type":"string","description":"Status message","example":"Successfully imported \"Cyberpunk 2077\" from Kinguin"},"isNew":{"type":"boolean","description":"Whether this was a new product or update to existing","example":true}},"required":["success","productId","title","message","isNew"]},"CreatePaymentDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID (UUID)","example":"550e8400-e29b-41d4-a716-446655440000"},"email":{"type":"string","description":"Customer email address","example":"customer@example.com"},"priceAmount":{"type":"string","description":"Total price amount","example":"49.99"},"priceCurrency":{"type":"string","description":"Price currency (fiat)","example":"eur"},"payCurrency":{"type":"string","description":"Cryptocurrency to accept (optional, user chooses at payment page)","example":"btc"}},"required":["orderId","email","priceAmount","priceCurrency"]},"PaymentResponseDto":{"type":"object","properties":{"invoiceId":{"type":"number","description":"NOWPayments invoice ID","example":123456},"invoiceUrl":{"type":"string","description":"Invoice URL for customer to complete payment","example":"https://nowpayments.io/invoice/..."},"statusUrl":{"type":"string","description":"Status tracking URL","example":"https://nowpayments.io/status/..."},"payAddress":{"type":"string","description":"Cryptocurrency payment address","example":"bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh"},"priceAmount":{"type":"number","description":"Amount to pay in fiat","example":49.99},"payAmount":{"type":"number","description":"Amount to pay in crypto","example":0.001234},"payCurrency":{"type":"string","description":"Cryptocurrency code","example":"btc"},"status":{"type":"string","description":"Payment status","example":"waiting"},"expirationDate":{"type":"string","description":"Payment expiration date (ISO string)","example":"2025-11-08T23:59:59Z"}},"required":["invoiceId","invoiceUrl","statusUrl","payAddress","priceAmount","payAmount","payCurrency","status","expirationDate"]},"IpnRequestDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID that maps to NOWPayments invoice order_id","example":"550e8400-e29b-41d4-a716-446655440000"},"externalId":{"type":"string","description":"NOWPayments external payment ID (same as invoiceId)","example":"fake_550e8400-..."},"status":{"type":"string","description":"Payment status from NOWPayments (waiting, confirming, finished, failed, etc)","example":"finished"},"payAmount":{"type":"number","description":"Amount paid in crypto","example":0.001234},"payCurrency":{"type":"string","description":"Cryptocurrency code","example":"btc"},"confirmations":{"type":"number","description":"Number of confirmations","example":0}},"required":["orderId","externalId","status"]},"IpnResponseDto":{"type":"object","properties":{"ok":{"type":"boolean","description":"Webhook processed successfully","example":true},"message":{"type":"string","description":"Optional message","example":"Payment processed"}},"required":["ok"]},"FulfillmentStatusDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID","example":"550e8400-e29b-41d4-a716-446655440000"},"status":{"type":"string","description":"Current order status","example":"paid"},"itemsFulfilled":{"type":"number","description":"Number of items fulfilled","example":2},"itemsTotal":{"type":"number","description":"Total number of items in order","example":3},"allFulfilled":{"type":"boolean","description":"Whether all items are fulfilled","example":true},"updatedAt":{"format":"date-time","type":"string","description":"Last update timestamp","example":"2025-11-10T15:30:00.000Z"}},"required":["orderId","status","itemsFulfilled","itemsTotal","allFulfilled","updatedAt"]},"DeliveryLinkDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID","example":"550e8400-e29b-41d4-a716-446655440000"},"signedUrl":{"type":"string","description":"Signed download URL (expires in 15 min)","example":"https://r2-example.example.com/orders/550e8400.json?signature=xyz"},"expiresAt":{"format":"date-time","type":"string","description":"URL expiry timestamp (ISO8601)","example":"2025-11-08T14:15:00Z"},"itemCount":{"type":"number","description":"Number of items available","example":3},"message":{"type":"string","description":"Delivery message","example":"Your order is ready for download. Link expires in 15 minutes."}},"required":["orderId","signedUrl","expiresAt","itemCount","message"]},"RevealedKeyDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID","example":"550e8400-e29b-41d4-a716-446655440000"},"itemId":{"type":"string","description":"Item ID","example":"4f5d7890-1234-5678-9abc-def012345678"},"plainKey":{"type":"string","description":"Decrypted license key","example":"KEY-ABC123XYZ789"},"contentType":{"type":"string","description":"Content type of the key data (text/plain, image/jpeg, image/png, image/gif)","example":"text/plain"},"revealedAt":{"format":"date-time","type":"string","description":"Key revelation timestamp (ISO8601)","example":"2025-11-08T14:00:00Z"},"expiresAt":{"format":"date-time","type":"string","description":"Key expiration timestamp (ISO8601)","example":"2025-11-08T14:15:00Z"},"downloadCount":{"type":"number","description":"Number of times accessed","example":1},"accessInfo":{"type":"object","description":"Access information","example":{"ipAddress":"192.168.1.100","userAgent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64)"}}},"required":["orderId","itemId","plainKey","contentType","revealedAt","expiresAt","downloadCount","accessInfo"]},"HealthCheckResultDto":{"type":"object","properties":{"service":{"type":"string","description":"Service name","example":"FulfillmentService"},"status":{"type":"string","description":"Health status","example":"healthy","enum":["healthy","degraded","unhealthy"]},"dependencies":{"type":"object","description":"Dependency status","example":{"r2Storage":true}},"timestamp":{"format":"date-time","type":"string","description":"Check timestamp (ISO8601)","example":"2025-11-08T14:00:00Z"},"error":{"type":"string","description":"Error message (if any)","example":"R2 storage connection timeout"}},"required":["service","status","dependencies","timestamp"]},"UpdatePasswordDto":{"type":"object","properties":{"oldPassword":{"type":"string"},"newPassword":{"type":"string"}},"required":["oldPassword","newPassword"]},"CreateAuditLogDto":{"type":"object","properties":{"adminUserId":{"type":"string","description":"Admin user ID"},"action":{"type":"string","description":"Action performed"},"target":{"type":"string","description":"Target resource"},"payload":{"type":"object","description":"Action payload"},"details":{"type":"string","description":"Action details"}},"required":["adminUserId","action","target"]},"AuditAdminDto":{"type":"object","properties":{"id":{"type":"string"},"email":{"type":"string"}},"required":["id","email"]},"AuditLogResponseDto":{"type":"object","properties":{"id":{"type":"string"},"adminUserId":{"type":"string"},"admin":{"$ref":"#/components/schemas/AuditAdminDto"},"action":{"type":"string"},"target":{"type":"string"},"payload":{"type":"object"},"details":{"type":"string"},"createdAt":{"format":"date-time","type":"string"}},"required":["id","adminUserId","action","target","createdAt"]},"PaginatedAuditLogsDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/AuditLogResponseDto"}},"total":{"type":"number"},"limit":{"type":"number"},"offset":{"type":"number"},"pages":{"type":"number"}},"required":["data","total","limit","offset","pages"]},"ReviewResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"550e8400-e29b-41d4-a716-446655440000"},"rating":{"type":"number","example":5},"title":{"type":"string","nullable":true,"example":"Great product!"},"content":{"type":"string","example":"Fast delivery and works perfectly."},"authorName":{"type":"string","example":"John D."},"isVerifiedPurchase":{"type":"boolean","example":true},"productName":{"type":"string","nullable":true,"example":"Product Name"},"createdAt":{"format":"date-time","type":"string","example":"2025-01-15T10:30:00.000Z"}},"required":["id","rating","content","authorName","isVerifiedPurchase","createdAt"]},"PaginatedReviewsDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/ReviewResponseDto"}},"total":{"type":"number","example":100},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":10}},"required":["data","total","page","limit","totalPages"]},"CreateReviewDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID this review is for","example":"550e8400-e29b-41d4-a716-446655440000"},"productId":{"type":"string","description":"Specific product ID being reviewed (optional, for multi-product orders)","example":"550e8400-e29b-41d4-a716-446655440001"},"rating":{"type":"number","description":"Star rating (1-5)","example":5,"minimum":1,"maximum":5},"title":{"type":"string","description":"Review title/headline","example":"Great product, fast delivery!","maxLength":255},"content":{"type":"string","description":"Review content/body","example":"I received my key instantly after payment. Works perfectly!","minLength":10,"maxLength":2000},"authorName":{"type":"string","description":"Display name for the review (optional, will use email username if not provided)","example":"John D.","maxLength":100}},"required":["orderId","rating","content"]},"UpdateReviewDto":{"type":"object","properties":{"rating":{"type":"number","description":"Star rating (1-5)","example":4,"minimum":1,"maximum":5},"title":{"type":"string","description":"Review title/headline","example":"Updated: Still great!","maxLength":255},"content":{"type":"string","description":"Review content/body","example":"Updated my review after using the product more.","minLength":10,"maxLength":2000},"authorName":{"type":"string","description":"Display name for the review","example":"John D.","maxLength":100}}},"AdminReviewResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"550e8400-e29b-41d4-a716-446655440000"},"rating":{"type":"number","example":5},"title":{"type":"string","nullable":true,"example":"Great product!"},"content":{"type":"string","example":"Fast delivery and works perfectly."},"authorName":{"type":"string","example":"John D."},"isVerifiedPurchase":{"type":"boolean","example":true},"productName":{"type":"string","nullable":true,"example":"Product Name"},"createdAt":{"format":"date-time","type":"string","example":"2025-01-15T10:30:00.000Z"},"orderId":{"type":"string","nullable":true,"example":"550e8400-e29b-41d4-a716-446655440000"},"userId":{"type":"string","nullable":true,"example":"550e8400-e29b-41d4-a716-446655440001"},"userEmail":{"type":"string","nullable":true,"example":"user@example.com"},"productId":{"type":"string","nullable":true,"example":"550e8400-e29b-41d4-a716-446655440002"},"status":{"type":"string","enum":["pending","approved","rejected"],"example":"pending"},"displayOnHomepage":{"type":"boolean","example":false},"adminNotes":{"type":"string","nullable":true,"example":"Internal notes here"},"approvedById":{"type":"string","nullable":true,"example":"550e8400-e29b-41d4-a716-446655440003"},"approvedByEmail":{"type":"string","nullable":true,"example":"admin@bitloot.io"},"approvedAt":{"type":"string","format":"date-time","nullable":true,"example":"2025-01-15T12:00:00.000Z"},"updatedAt":{"format":"date-time","type":"string","example":"2025-01-15T10:30:00.000Z"}},"required":["id","rating","content","authorName","isVerifiedPurchase","createdAt","status","displayOnHomepage","updatedAt"]},"PaginatedAdminReviewsDto":{"type":"object","properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/AdminReviewResponseDto"}},"total":{"type":"number","example":100},"page":{"type":"number","example":1},"limit":{"type":"number","example":10},"totalPages":{"type":"number","example":10}},"required":["data","total","page","limit","totalPages"]},"ReviewStatsDto":{"type":"object","properties":{"totalReviews":{"type":"number","example":150},"averageRating":{"type":"number","example":4.7},"ratingBreakdown":{"type":"object","description":"Breakdown by rating","example":{"1":5,"2":10,"3":20,"4":40,"5":75}},"statusBreakdown":{"type":"object","description":"Breakdown by status","example":{"pending":15,"approved":130,"rejected":5}}},"required":["totalReviews","averageRating","ratingBreakdown","statusBreakdown"]},"AdminCreateReviewDto":{"type":"object","properties":{"orderId":{"type":"string","description":"Order ID (optional for admin-created reviews)","example":"550e8400-e29b-41d4-a716-446655440000"},"productId":{"type":"string","description":"Product ID being reviewed","example":"550e8400-e29b-41d4-a716-446655440001"},"rating":{"type":"number","description":"Star rating (1-5)","example":5,"minimum":1,"maximum":5},"title":{"type":"string","description":"Review title/headline","example":"Amazing service!","maxLength":255},"content":{"type":"string","description":"Review content/body","example":"BitLoot provided excellent service and instant delivery!","minLength":10,"maxLength":2000},"authorName":{"type":"string","description":"Display name for the reviewer","example":"Happy Customer","maxLength":100},"status":{"type":"string","description":"Initial status (defaults to pending)","enum":["pending","approved","rejected"],"example":"approved"},"displayOnHomepage":{"type":"boolean","description":"Whether to display on homepage","example":true},"isVerifiedPurchase":{"type":"boolean","description":"Mark as verified purchase (defaults to false for admin-created)","example":false},"adminNotes":{"type":"string","description":"Internal admin notes","example":"Created from customer email testimonial","maxLength":1000}},"required":["rating","content","authorName"]},"AdminUpdateReviewDto":{"type":"object","properties":{"rating":{"type":"number","description":"Star rating (1-5)","example":5,"minimum":1,"maximum":5},"title":{"type":"string","description":"Review title/headline","example":"Edited title","maxLength":255},"content":{"type":"string","description":"Review content/body","example":"Edited content","minLength":10,"maxLength":2000},"authorName":{"type":"string","description":"Display name for the reviewer","example":"Valued Customer","maxLength":100},"status":{"type":"string","description":"Moderation status","enum":["pending","approved","rejected"],"example":"approved"},"displayOnHomepage":{"type":"boolean","description":"Whether to display on homepage","example":true},"adminNotes":{"type":"string","description":"Internal admin notes","example":"Approved after content review","maxLength":1000}}},"ModerateReviewDto":{"type":"object","properties":{"status":{"type":"string","description":"New status (approved or rejected)","enum":["approved","rejected"],"example":"approved"},"displayOnHomepage":{"type":"boolean","description":"Whether to display on homepage (only applies when approving)","example":true},"adminNotes":{"type":"string","description":"Admin notes about the decision","example":"Approved - genuine customer feedback","maxLength":1000}},"required":["status"]},"WatchlistProductDto":{"type":"object","properties":{"id":{"type":"string","description":"Product ID"},"slug":{"type":"string","description":"Product slug for URL"},"title":{"type":"string","description":"Product title"},"subtitle":{"type":"string","description":"Product subtitle","nullable":true},"coverImageUrl":{"type":"string","description":"Cover image URL","nullable":true},"platform":{"type":"string","description":"Product platform (Steam, Epic, etc.)","nullable":true},"region":{"type":"string","description":"Product region","nullable":true},"price":{"type":"number","description":"Product price in USD"},"isPublished":{"type":"boolean","description":"Whether product is currently available"}},"required":["id","slug","title","price","isPublished"]},"WatchlistItemResponseDto":{"type":"object","properties":{"id":{"type":"string","description":"Watchlist item ID"},"userId":{"type":"string","description":"User ID who owns this watchlist item"},"productId":{"type":"string","description":"Product ID in the watchlist"},"product":{"description":"Product details","allOf":[{"$ref":"#/components/schemas/WatchlistProductDto"}]},"createdAt":{"format":"date-time","type":"string","description":"When the item was added to watchlist"}},"required":["id","userId","productId","product","createdAt"]},"PaginatedWatchlistResponseDto":{"type":"object","properties":{"data":{"description":"List of watchlist items","type":"array","items":{"$ref":"#/components/schemas/WatchlistItemResponseDto"}},"total":{"type":"number","description":"Total number of items in watchlist"},"page":{"type":"number","description":"Current page number"},"limit":{"type":"number","description":"Number of items per page"},"totalPages":{"type":"number","description":"Total number of pages"}},"required":["data","total","page","limit","totalPages"]},"AddToWatchlistDto":{"type":"object","properties":{"productId":{"type":"string","description":"Product ID to add to watchlist","example":"550e8400-e29b-41d4-a716-446655440000"}},"required":["productId"]},"CheckWatchlistResponseDto":{"type":"object","properties":{"isInWatchlist":{"type":"boolean","description":"Whether the product is in the user's watchlist"},"watchlistItemId":{"type":"string","description":"Watchlist item ID if in watchlist"}},"required":["isInWatchlist"]}}}}